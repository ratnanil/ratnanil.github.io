<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Nils Ratnaweera">
<meta name="dcterms.date" content="2022-07-07">
<meta name="description" content="What">

<title>Ratnaweera-XYZ - Making sense of data with dm</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/all.css" rel="stylesheet">
<link href="../../site_libs/quarto-contrib/fontawesome6-0.1.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="../../site_libs/viz-1.8.2/viz.js"></script>
<link href="../../site_libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="../../site_libs/grViz-binding-1.0.9/grViz.js"></script>


<link rel="stylesheet" href="../../styles.css">
<meta property="og:title" content="Ratnaweera-XYZ - Making sense of data with dm">
<meta property="og:description" content="What">
<meta property="og:site-name" content="Ratnaweera-XYZ">
<meta name="twitter:title" content="Ratnaweera-XYZ - Making sense of data with dm">
<meta name="twitter:description" content="What">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-fixed fullcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../../images/mylogo.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Ratnaweera-XYZ</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text"><i class="fa-solid fa-house fa-fw" aria-label="house"></i> Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">
 <span class="menu-text"><i class="fa-solid fa-rss fa-fw" aria-label="rss"></i> Blog</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../teaching.html">
 <span class="menu-text"><i class="fa-solid fa-person-chalkboard" aria-label="person-chalkboard"></i> Teaching</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-fa-tablet-screen-button--apps" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text"><i class="fa-solid fa-tablet-screen-button" aria-label="tablet-screen-button"></i> Apps</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-fa-tablet-screen-button--apps">    
        <li>
    <a class="dropdown-item" href="../../apps/geodienste-kantone/index.html">
 <span class="dropdown-text">Geodienste-Monitor</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../apps/stackexchange/index.html">
 <span class="dropdown-text">StackExchange-Tags</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="../../CV.html">
 <span class="menu-text"><i class="fa-solid fa-feather-pointed" aria-label="feather-pointed"></i> About</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="../../github.com/ratnanil/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/NRatnaweera"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://fosstodon.org/@ratnaweera"><i class="bi bi-mastodon" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://stackoverflow.com/users/4139249/ratnanil"><i class="bi bi-stack-overflow" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Making sense of data with dm</h1>
                  <div>
        <div class="description">
          <p>What</p>
        </div>
      </div>
                </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Nils Ratnaweera </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">July 7, 2022</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<div class="cell">
<style type="text/css">

.sdg-images{
  display: grid; 
  grid-template-columns: auto auto auto auto auto auto;
}

.sdg-images>img{
  width: 100%;
  padding: 3px;
  border: 1px solid #ADB5BD;
}
</style>
</div>
<p>I have a confession to make: I love cleaning data. While I seem to hear a lot of people complaining that 80% of all Data Science work is <em>just cleaning data</em>, this is a part of my work that I enjoy very much. Part of what makes data cleaning in R or Python so enjoyable is rather that <em>just</em> cleaning the data, I’m building a little machine (my script), that can clean up this data countless times.</p>
<p>Data cleaning also has a lot to do with understanding the data. While a good way to understand data is by visualizing it, another is by <em>normalizing</em> the data. And this approach has become extremely easy and rewarding with the <a href="https://www.cynkra.com"><code>dm</code> package by the Cynkra group</a>. Let me share my latest experience with <code>dm</code> when trying to wrap my head around the data provided by the UN regarding the <a href="https://sdgs.un.org/">Sustainable Development Goals</a> (SDG).</p>
<section id="what-are-the-sdgs" class="level1">
<h1>What are the SDGs?</h1>
<p>The Sustainable Development Goals are a collection of 17 goals designed to achieve <em>a better and more sustainable future for all</em>. The SDGs were set up in 2015 by the United Nations General Assembly as the future global development framework to succeed the Millennium Development Goals which were ended in 2015. These include goals such as ending world hunger, achieving gender equality and so on. You can read up on all 17 Goals on the dedicated website here: <a href="https://sdgs.un.org">sdgs.un.org</a>.</p>
<p>These goals has varying number of targets which in turn are monitored by indicators. I used the SDG API download these indicator values and will use the <code>dm</code> package to normalize and understand the dataset.</p>
<div class="sdg-images">
<img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-01.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-02.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-03.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-04.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-05.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-06.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-07.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-08.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-09.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-10.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-11.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-12.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-13.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-14.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-15.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-16.png"> <img src="E-Transparent-Inverted-Icons/SDG_Icons_Inverted_Transparent_WEB-17.png">
<div>

<p><br><br></p>
</div></div></section>
<section id="getting-the-data" class="level1">
<h1>Getting the data</h1>
<div class="cell">
<details>
<summary>loading the necessary libraries</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dm)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(purrr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># yes I could have just loaded the tidyverse, but I'm trying to avoid this practice</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(httr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Let’s start with something simple, the 17 SDGs. Using the package <code>httr</code> I can <code>GET</code> the 17 SDGs as <a href="https://unstats.un.org/SDGAPI/swagger/">described in the docs</a>. <code>GET</code> returns many things, I’m mostly interested in the <code>content</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>sdg_goal_list <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">"https://unstats.un.org/SDGAPI/v1/sdg/Goal/List"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">content</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<p>Typically, such an API all will return a JSON, which is automatically converted into a named list:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sdg_goal_list, <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
[[1]]$code
[1] "1"

[[1]]$title
[1] "End poverty in all its forms everywhere"

[[1]]$description
[1] "Goal 1 calls for an end to poverty in all its manifestations, including extreme poverty, over the next 15 years. All people everywhere, including the poorest and most vulnerable, should enjoy a basic standard of living and social protection benefits."

[[1]]$uri
[1] "/v1/sdg/Goal/1"</code></pre>
</div>
</div>
<p>To turn this into a data.frame, I can simply call <code>purrr::map_dfr()</code> on the list. But I don’t want a simple data.frame, I want to create a data<em>base</em>, which just takes an additional step, which is calling the function <code>dm</code> on the data.frame.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>sdg_goals <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(sdg_goal_list, <span class="sc">~</span>.x)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> <span class="fu">dm</span>(sdg_goals)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>database</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>── Metadata ────────────────────────────────────────────────────────────────────
Tables: `sdg_goals`
Columns: 4
Primary keys: 0
Foreign keys: 0</code></pre>
</div>
</div>
</section>
<section id="not-much-pain-but-not-much-pain-either.-what-do-we-gain-from-createding-this-dm-object" class="level1">
<h1>Not much pain, but not much pain either. What do we gain from createding this <code>dm</code> object?</h1>
<p>Well, now we can start adding restriction on our data and making quality checks. For example, I would expect each <em>Goal Number</em> (column <code>code</code>) to be unique. I can check this with <code>check_key()</code> and if my assumtion is true (which it is), I can use it as a primary key.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># the test is performed on the dataframe:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">check_key</span>(sdg_goals, code)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># specifying a primary key is done in the "database" </span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> database <span class="sc">|&gt;</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(sdg_goals, code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="maybe-check_key-was-useful-but-what-did-dm_add_pk-give-us" class="level1">
<h1>Maybe <code>check_key</code> was useful, but what did <code>dm_add_pk</code> give us?</h1>
<p>You’ll see soon enough! First, let’s import the “SDG Targets”</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>sdg_target_list <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">"https://unstats.un.org/SDGAPI/v1/sdg/Target/List"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">content</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>sdg_targets <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(sdg_target_list, <span class="sc">~</span>.x)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>sdg_targets</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 169 × 5
   goal  code  title                                               descr…¹ uri  
   &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;                                               &lt;chr&gt;   &lt;chr&gt;
 1 1     1.1   By 2030, eradicate extreme poverty for all people … By 203… /v1/…
 2 1     1.2   By 2030, reduce at least by half the proportion of… By 203… /v1/…
 3 1     1.3   Implement nationally appropriate social protection… Implem… /v1/…
 4 1     1.4   By 2030, ensure that all men and women, in particu… By 203… /v1/…
 5 1     1.5   By 2030, build the resilience of the poor and thos… By 203… /v1/…
 6 1     1.a   Ensure significant mobilization of resources from … Ensure… /v1/…
 7 1     1.b   Create sound policy frameworks at the national, re… Create… /v1/…
 8 2     2.1   By 2030, end hunger and ensure access by all peopl… By 203… /v1/…
 9 2     2.2   By 2030, end all forms of malnutrition, including … By 203… /v1/…
10 2     2.3   By 2030, double the agricultural productivity and … By 203… /v1/…
# … with 159 more rows, and abbreviated variable name ¹​description
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>So apparently, the unique identifier for each target is a composite of the goal number and the target number, separated by a decimal point (e.g.&nbsp;Goal 1 has multiple targets, 1.1, 1.2, 1.3…). I’m not a database expert, but this seems redundant, since I have the Goal Number in a separate column already. Let me clean this up:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>sdg_targets <span class="ot">&lt;-</span> sdg_targets <span class="sc">|&gt;</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">target_id =</span> <span class="fu">str_split_fixed</span>(code, <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>, <span class="dv">2</span>)[,<span class="dv">2</span>], <span class="co"># split by "." and take the 2nd element</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">.keep =</span> <span class="st">"unused"</span>, <span class="co"># love this new option, which drops the "code"-column</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">.after =</span> <span class="dv">1</span>        <span class="co"># also love this option, to add the new column to the left</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, I can check if the composition of <code>goal</code> and <code>target_id</code> is unique and if so, I’ll add the data.frame to the existing <code>database</code> with the mentioned columns as a primary key.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_key</span>(sdg_targets, goal, target_id)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="co"># is unique, since no output is returned</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> database <span class="sc">|&gt;</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_tbl</span>(sdg_targets) <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(sdg_targets, <span class="fu">c</span>(goal, target_id))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `dm_add_tbl()` was deprecated in dm 1.0.0.
Please use `dm()` instead.
Use `.name_repair = "unique"` if necessary.</code></pre>
</div>
</div>
<p>Now comes the part where <code>dm</code> really begins to shine. Since each target is associated with a goal, we can first check and then specify this relationship in the most elegant manner.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check is performed on the data.frames</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="fu">examine_cardinality</span>(sdg_goals, code, sdg_targets, goal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "surjective mapping (child: 1 to n -&gt; parent: 1)"</code></pre>
</div>
</div>
<p>Since the cardinality 1:n seems reasonable, we can specify the relationship between the two tables in our database by defining a “foreign key” from <code>sdg_targets</code> to <code>sdg_goals</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> database <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_targets, goal, sdg_goals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="this-is-getting-more-and-more-complicated-what-do-we-gain-from-all-this" class="level1">
<h1>This is getting more and more complicated, what do we gain from all this?!</h1>
<p>For one, we can get an overview of our mini database using the <code>dm_draw()</code> function.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_draw</span>(database, <span class="at">view_type =</span> <span class="st">"all"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-bd2bc984aed4715dfdf1" style="width:100%;height:464px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-bd2bc984aed4715dfdf1">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\npack=true\npackmode= \"node\"\n\n  \"sdg_goals\" [id = \"sdg_goals\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">sdg_goals<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"code\"><U>code<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">title<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">uri<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"sdg_targets\" [id = \"sdg_targets\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">sdg_targets<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goal\">goal<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">target_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">title<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">description<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\">uri<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goal, target_id\"><U>goal, target_id<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"sdg_targets\":\"goal\"->\"sdg_goals\":\"code\" [id=\"sdg_targets_1\"]\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><br><br></p>
<p>That alone was worth it, wasn’t it? But of course, this is not the only trick up <code>dm</code>’s sleeve: Now that the relationship between the two tables is specified, you can omit the <code>by =</code> statement when joining the two tables. You first need to <code>zoom</code> to the first table and then simply call the second one.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dm_zoom_to</span>(database, sdg_targets) <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(sdg_goals)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># Zoomed table: sdg_targets
# A tibble:     169 × 8
   goal  target_id title.sdg_targets     descr…¹ uri.s…² title…³ descr…⁴ uri.s…⁵
   &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;                 &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1 1     1         By 2030, eradicate e… By 203… /v1/sd… End po… Goal 1… /v1/sd…
 2 1     2         By 2030, reduce at l… By 203… /v1/sd… End po… Goal 1… /v1/sd…
 3 1     3         Implement nationally… Implem… /v1/sd… End po… Goal 1… /v1/sd…
 4 1     4         By 2030, ensure that… By 203… /v1/sd… End po… Goal 1… /v1/sd…
 5 1     5         By 2030, build the r… By 203… /v1/sd… End po… Goal 1… /v1/sd…
 6 1     a         Ensure significant m… Ensure… /v1/sd… End po… Goal 1… /v1/sd…
 7 1     b         Create sound policy … Create… /v1/sd… End po… Goal 1… /v1/sd…
 8 2     1         By 2030, end hunger … By 203… /v1/sd… End hu… Goal 2… /v1/sd…
 9 2     2         By 2030, end all for… By 203… /v1/sd… End hu… Goal 2… /v1/sd…
10 2     3         By 2030, double the … By 203… /v1/sd… End hu… Goal 2… /v1/sd…
# … with 159 more rows, and abbreviated variable names
#   ¹​description.sdg_targets, ²​uri.sdg_targets, ³​title.sdg_goals,
#   ⁴​description.sdg_goals, ⁵​uri.sdg_goals
# ℹ Use `print(n = ...)` to see more rows</code></pre>
</div>
</div>
<p>Of course, we could have performed this join without the help of <code>dm</code>. However, as our data structure becomes more and more complicated, keeping our stuff in a database helps us keep an overview of data data and our data clean. Let me illustrate by loading the rest of the data from the API.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> database <span class="sc">|&gt;</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_rename</span>(sdg_goals, <span class="at">goals_id =</span> code) <span class="sc">|&gt;</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_rename</span>(sdg_targets, <span class="at">goal_id =</span> goal)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>sdg_indicator_list <span class="ot">&lt;-</span> <span class="fu">GET</span>(<span class="st">"https://unstats.un.org/SDGAPI/v1/sdg/Indicator/List"</span>) <span class="sc">|&gt;</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">content</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>sdg_indicators <span class="ot">&lt;-</span> <span class="fu">map_dfr</span>(sdg_indicator_list , <span class="sc">~</span>.x)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>sdg_indicators <span class="ot">&lt;-</span> sdg_indicators <span class="sc">|&gt;</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>goal, <span class="sc">-</span>target) <span class="sc">|&gt;</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(code, <span class="fu">c</span>(<span class="st">"goal_id"</span>,<span class="st">"target_id"</span>,<span class="st">"indicator_id"</span>),<span class="at">sep =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>series) <span class="sc">|&gt;</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>()) <span class="sc">|&gt;</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>() <span class="sc">|&gt;</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'goal_id', 'target_id', 'indicator_id',
'description', 'tier'. You can override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">check_key</span>(sdg_indicators, goal_id, target_id, indicator_id)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="co"># all good</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> database <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_tbl</span>(sdg_indicators) <span class="sc">|&gt;</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(sdg_indicators, <span class="fu">c</span>(goal_id, target_id, indicator_id)) <span class="sc">|&gt;</span> </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_indicators, <span class="fu">c</span>(goal_id, target_id), sdg_targets)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `dm_add_tbl()` was deprecated in dm 1.0.0.
Please use `dm()` instead.
Use `.name_repair = "unique"` if necessary.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>sdg_items <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"SDG_BulkDownloads_E_All_Data_(Normalized)/SDG_BulkDownloads_E_All_Data_(Normalized).csv"</span>, <span class="at">name_repair =</span> <span class="sc">~</span><span class="fu">str_replace_all</span>(<span class="fu">str_to_lower</span>(.), <span class="st">" "</span>, <span class="st">"_"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 158702 Columns: 12
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (9): area_code, area, item_code, item, element, unit, value, flag, note
dbl (3): element_code, year_code, year

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>sdg_items</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 158,702 × 12
   area_code area  item_…¹ item  eleme…² element year_…³  year unit  value flag 
   &lt;chr&gt;     &lt;chr&gt; &lt;chr&gt;   &lt;chr&gt;   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt;
 1 004       Afgh… SN_ITK… 2.1.…    6132 Value      2001  2001 mill… 10.3  _    
 2 004       Afgh… SN_ITK… 2.1.…    6132 Value      2002  2002 mill… 10.3  _    
 3 004       Afgh… SN_ITK… 2.1.…    6132 Value      2003  2003 mill… 9.6   _    
 4 004       Afgh… SN_ITK… 2.1.…    6132 Value      2004  2004 mill… 9.4   _    
 5 004       Afgh… SN_ITK… 2.1.…    6132 Value      2005  2005 mill… 9.2   _    
 6 004       Afgh… SN_ITK… 2.1.…    6132 Value      2006  2006 mill… 8.8   _    
 7 004       Afgh… SN_ITK… 2.1.…    6132 Value      2007  2007 mill… 8.1   _    
 8 004       Afgh… SN_ITK… 2.1.…    6132 Value      2008  2008 mill… 7.4   _    
 9 004       Afgh… SN_ITK… 2.1.…    6132 Value      2009  2009 mill… 6.9   _    
10 004       Afgh… SN_ITK… 2.1.…    6132 Value      2010  2010 mill… 6.9   _    
# … with 158,692 more rows, 1 more variable: note &lt;chr&gt;, and abbreviated
#   variable names ¹​item_code, ²​element_code, ³​year_code
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
<p>The table above contains nearly 160k observations. Each observation is a measurement of a specific indicator (e.g.&nbsp;<em>Number of undernourished people</em>) made in a specific area (e.g.&nbsp;<em>Afghanistan</em>) for a specific year (e.g.&nbsp;<em>2001</em>). The table contains additional information such as the indicator it concerns and the unit it is measured in, but this information is unique to the item code (1:1 relationship), so I will separated it out.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>sdg_items_codes <span class="ot">&lt;-</span> sdg_items <span class="sc">|&gt;</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item_code, item, element_code, unit) <span class="sc">|&gt;</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># flag and note are NOT unique to item_code</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>()) <span class="sc">|&gt;</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>() <span class="sc">|&gt;</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'item_code', 'item', 'element_code'. You
can override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this should return an empty tibble</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>sdg_items_codes <span class="sc">|&gt;</span> </span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(item_code) <span class="sc">|&gt;</span> </span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_count</span>() <span class="sc">|&gt;</span> </span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n<span class="sc">&gt;</span><span class="dv">1</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 5
# Groups:   item_code [1]
  item_code       item                                       eleme…¹ unit      n
  &lt;chr&gt;           &lt;chr&gt;                                        &lt;dbl&gt; &lt;chr&gt; &lt;int&gt;
1 AG_PRD_FIESMSN_ 2.1.2 Population in moderate or severe fo…    6199 1000…     2
2 AG_PRD_FIESMSN_ 2.1.2 Population in moderate or severe fo…    6199 1000…     2
# … with abbreviated variable name ¹​element_code</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># but it does not, since there was one coding error which must be fixed. </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Item code "AG_PRD_FIESMSN_" lacks information on sex, which is typically</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="co"># stored as _M and _F. Will fix this manually here:</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>sdg_items<span class="sc">$</span>item_code[sdg_items<span class="sc">$</span>item_code <span class="sc">==</span> <span class="st">"AG_PRD_FIESMSN_"</span> <span class="sc">&amp;</span> <span class="fu">str_detect</span>(sdg_items<span class="sc">$</span>item, <span class="st">"</span><span class="sc">\\</span><span class="st">(female</span><span class="sc">\\</span><span class="st">)"</span>)] <span class="ot">&lt;-</span> <span class="st">"AG_PRD_FIESMSN_F"</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>sdg_items<span class="sc">$</span>item_code[sdg_items<span class="sc">$</span>item_code <span class="sc">==</span> <span class="st">"AG_PRD_FIESMSN_"</span> <span class="sc">&amp;</span> <span class="fu">str_detect</span>(sdg_items<span class="sc">$</span>item, <span class="st">"</span><span class="sc">\\</span><span class="st">(male</span><span class="sc">\\</span><span class="st">)"</span>)] <span class="ot">&lt;-</span> <span class="st">"AG_PRD_FIESMSN_M"</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>sdg_items_codes <span class="ot">&lt;-</span> sdg_items <span class="sc">|&gt;</span></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(item_code, item, element_code, unit) <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># flag and note are NOT unique to item_code</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(<span class="fu">across</span>()) <span class="sc">|&gt;</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'item_code', 'item', 'element_code'. You
can override using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>sdg_items_codes <span class="ot">&lt;-</span> sdg_items_codes <span class="sc">|&gt;</span> </span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">target =</span> <span class="fu">str_extract</span>(item, <span class="st">"</span><span class="sc">\\</span><span class="st">d{1,2}</span><span class="sc">\\</span><span class="st">..</span><span class="sc">\\</span><span class="st">.."</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">separate</span>(target, <span class="fu">c</span>(<span class="st">"goal_id"</span>,<span class="st">"target_id"</span>,<span class="st">"indicator_id"</span>),<span class="at">sep =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">."</span>) </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>sdg_items <span class="ot">&lt;-</span> sdg_items <span class="sc">|&gt;</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>area,           <span class="co"># since we have area_code</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>item,           <span class="co"># since we have item_code</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>element_code,   <span class="co"># since we have item_code</span></span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>unit,           <span class="co"># since we have item_code</span></span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>element,        <span class="co"># since it's always "value"</span></span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>    <span class="sc">-</span>year_code,      <span class="co"># since year == year_code</span></span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> dm<span class="sc">::</span><span class="fu">dm_add_tbl</span>(database, sdg_items, sdg_items_codes) <span class="sc">|&gt;</span> </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(sdg_items, <span class="fu">c</span>(item_code, year)) <span class="sc">|&gt;</span> </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(sdg_items_codes, item_code) <span class="sc">|&gt;</span> </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_items, item_code, sdg_items_codes) <span class="sc">|&gt;</span> </span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_items_codes, <span class="fu">c</span>(goal_id, target_id, indicator_id), sdg_indicators)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `dm_add_tbl()` was deprecated in dm 1.0.0.
Please use `dm()` instead.
Use `.name_repair = "unique"` if necessary.</code></pre>
</div>
</div>
<p>Next I want to add country information on each code. For this, I will not use the data provided by the API, since I don’t really like the format it’s provided in. Instead, I will use the csv file which can be downloaded <a href="https://unstats.un.org/unsd/methodology/m49/">here</a>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>area_codes <span class="ot">&lt;-</span> <span class="fu">read_delim</span>(<span class="st">"data/UNSD — Methodology.csv"</span>, <span class="st">";"</span>, <span class="at">name_repair =</span> <span class="sc">~</span><span class="fu">str_remove_all</span>(<span class="fu">str_replace_all</span>(<span class="fu">str_to_lower</span>(.x), <span class="st">"</span><span class="sc">\\</span><span class="st">s|-"</span>, <span class="st">"_"</span>), <span class="st">"</span><span class="sc">\\</span><span class="st">(|</span><span class="sc">\\</span><span class="st">)"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 249 Columns: 15
── Column specification ────────────────────────────────────────────────────────
Delimiter: ";"
chr (15): global_code, global_name, region_code, region_name, sub_region_cod...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>area_codes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 249 × 15
   global_code global_…¹ regio…² regio…³ sub_r…⁴ sub_r…⁵ inter…⁶ inter…⁷ count…⁸
   &lt;chr&gt;       &lt;chr&gt;     &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;  
 1 001         World     002     Africa  015     Northe… &lt;NA&gt;    &lt;NA&gt;    Algeria
 2 001         World     002     Africa  015     Northe… &lt;NA&gt;    &lt;NA&gt;    Egypt  
 3 001         World     002     Africa  015     Northe… &lt;NA&gt;    &lt;NA&gt;    Libya  
 4 001         World     002     Africa  015     Northe… &lt;NA&gt;    &lt;NA&gt;    Morocco
 5 001         World     002     Africa  015     Northe… &lt;NA&gt;    &lt;NA&gt;    Sudan  
 6 001         World     002     Africa  015     Northe… &lt;NA&gt;    &lt;NA&gt;    Tunisia
 7 001         World     002     Africa  015     Northe… &lt;NA&gt;    &lt;NA&gt;    Wester…
 8 001         World     002     Africa  202     Sub-Sa… 014     Easter… Britis…
 9 001         World     002     Africa  202     Sub-Sa… 014     Easter… Burundi
10 001         World     002     Africa  202     Sub-Sa… 014     Easter… Comoros
# … with 239 more rows, 6 more variables: m49_code &lt;chr&gt;,
#   iso_alpha2_code &lt;chr&gt;, iso_alpha3_code &lt;chr&gt;,
#   least_developed_countries_ldc &lt;chr&gt;,
#   land_locked_developing_countries_lldc &lt;chr&gt;,
#   small_island_developing_states_sids &lt;chr&gt;, and abbreviated variable names
#   ¹​global_name, ²​region_code, ³​region_name, ⁴​sub_region_code,
#   ⁵​sub_region_name, ⁶​intermediate_region_code, ⁷​intermediate_region_name, …
# ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</code></pre>
</div>
</div>
<p>It turns out, that many of the area codes are actually aggregated countries, e.g.&nbsp;area code 1 represents the entire world.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>area_codes_country <span class="ot">&lt;-</span> <span class="fu">mutate</span>(area_codes, <span class="at">area_code =</span> m49_code, <span class="at">.keep =</span> <span class="st">"unused"</span>, <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>area_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"global"</span>, <span class="st">"region"</span>,<span class="st">"sub_region"</span>,<span class="st">"intermediate_region"</span>) </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>area_levels <span class="ot">&lt;-</span> <span class="fu">set_names</span>(<span class="fu">accumulate</span>(area_levels, <span class="cf">function</span>(x, y){<span class="fu">c</span>(x,y)}), area_levels)</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>area_codes_higher_levels <span class="ot">&lt;-</span> <span class="fu">imap</span>(area_levels, <span class="cf">function</span>(x,y){</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  main <span class="ot">&lt;-</span> <span class="fu">tail</span>(x, <span class="dv">1</span>)</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  area_codes <span class="sc">|&gt;</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(<span class="fu">starts_with</span>(main) <span class="sc">|</span> <span class="fu">matches</span>(<span class="fu">paste0</span>(<span class="st">"^"</span>, x, <span class="st">"_code$"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># rename_with(~str_replace(., paste0(x,"_"), "area_")) |&gt; </span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(<span class="fu">across</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">na.omit</span>()</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`summarise()` has grouped output by 'global_code'. You can override using the
`.groups` argument.
`summarise()` has grouped output by 'region_code', 'region_name'. You can
override using the `.groups` argument.
`summarise()` has grouped output by 'sub_region_code', 'sub_region_name',
'global_code'. You can override using the `.groups` argument.
`summarise()` has grouped output by 'intermediate_region_code',
'intermediate_region_name', 'global_code', 'region_code'. You can override
using the `.groups` argument.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>database <span class="ot">&lt;-</span> <span class="fu">dm_add_tbl</span>(database, area_codes_country, </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>           <span class="at">area_codes_global =</span> area_codes_higher_levels<span class="sc">$</span>global,</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">area_codes_region =</span> area_codes_higher_levels<span class="sc">$</span>region,</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">area_codes_sub_region =</span> area_codes_higher_levels<span class="sc">$</span>sub_region,</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">area_codes_intermediate_region =</span> area_codes_higher_levels<span class="sc">$</span>intermediate_region,</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>           ) <span class="sc">|&gt;</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(area_codes_country, area_code) <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(area_codes_global, global_code) <span class="sc">|&gt;</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(area_codes_region, region_code) <span class="sc">|&gt;</span> </span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(area_codes_sub_region, sub_region_code) <span class="sc">|&gt;</span> </span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_pk</span>(area_codes_intermediate_region, intermediate_region_code) <span class="sc">|&gt;</span> </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_items, area_code, area_codes_country) <span class="sc">|&gt;</span> </span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_items, area_code, area_codes_global) <span class="sc">|&gt;</span> </span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_items, area_code, area_codes_region) <span class="sc">|&gt;</span> </span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_items, area_code, area_codes_sub_region) <span class="sc">|&gt;</span> </span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_add_fk</span>(sdg_items, area_code, area_codes_intermediate_region) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: `dm_add_tbl()` was deprecated in dm 1.0.0.
Please use `dm()` instead.
Use `.name_repair = "unique"` if necessary.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>database <span class="sc">|&gt;</span> </span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_set_colors</span>(<span class="st">"#ffa07a"</span> <span class="ot">=</span> sdg_items,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">"#00e0e0"</span> <span class="ot">=</span> <span class="fu">starts_with</span>(<span class="st">"area_codes"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dm_draw</span>(<span class="at">view_type =</span> <span class="st">"keys_only"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div id="htmlwidget-4241e7db08b1b7417521" style="width:100%;height:464px;" class="grViz html-widget"></div>
<script type="application/json" data-for="htmlwidget-4241e7db08b1b7417521">{"x":{"diagram":"#data_model\ndigraph {\ngraph [rankdir=LR tooltip=\"Data Model\" ]\n\nnode [margin=0 fontcolor = \"#444444\" ]\n\nedge [color = \"#555555\", arrowsize = 1, ]\n\npack=true\npackmode= \"node\"\n\n  \"area_codes_country\" [id = \"area_codes_country\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#009595AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#00E0E0FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">area_codes_country<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#CCF8F8FF\" PORT=\"area_code\"><U>area_code<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"area_codes_global\" [id = \"area_codes_global\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#009595AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#00E0E0FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">area_codes_global<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#CCF8F8FF\" PORT=\"global_code\"><U>global_code<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"area_codes_intermediate_region\" [id = \"area_codes_intermediate_region\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#009595AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#00E0E0FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">area_codes_intermediate_region<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#CCF8F8FF\" PORT=\"intermediate_region_code\"><U>intermediate_region_code<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"area_codes_region\" [id = \"area_codes_region\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#009595AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#00E0E0FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">area_codes_region<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#CCF8F8FF\" PORT=\"region_code\"><U>region_code<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"area_codes_sub_region\" [id = \"area_codes_sub_region\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#009595AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#00E0E0FF\" BORDER=\"0\"><FONT COLOR=\"#000000\">area_codes_sub_region<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#CCF8F8FF\" PORT=\"sub_region_code\"><U>sub_region_code<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"sdg_goals\" [id = \"sdg_goals\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">sdg_goals<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goals_id\"><U>goals_id<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"sdg_indicators\" [id = \"sdg_indicators\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">sdg_indicators<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goal_id, target_id, indicator_id\"><U>goal_id, target_id, indicator_id<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goal_id, target_id\">goal_id, target_id<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"sdg_items\" [id = \"sdg_items\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#AA6A51AA\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#FFA07AFF\" BORDER=\"0\"><FONT COLOR=\"#000000\">sdg_items<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFECE4FF\" PORT=\"area_code\">area_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFECE4FF\" PORT=\"item_code\">item_code<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFECE4FF\" PORT=\"item_code, year\"><U>item_code, year<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"sdg_items_codes\" [id = \"sdg_items_codes\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">sdg_items_codes<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"item_code\"><U>item_code<\/U><\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goal_id, target_id, indicator_id\">goal_id, target_id, indicator_id<\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n  \"sdg_targets\" [id = \"sdg_targets\", label = <<TABLE ALIGN=\"LEFT\" BORDER=\"1\" CELLBORDER=\"0\" CELLSPACING=\"0\" COLOR=\"#555555\">\n    <TR>\n      <TD COLSPAN=\"1\" BGCOLOR=\"#EFEBDD\" BORDER=\"0\"><FONT COLOR=\"#000000\">sdg_targets<\/FONT>\n<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goal_id\">goal_id<\/TD>\n    <\/TR>\n    <TR>\n      <TD ALIGN=\"LEFT\" BGCOLOR=\"#FFFFFF\" PORT=\"goal_id, target_id\"><U>goal_id, target_id<\/U><\/TD>\n    <\/TR>\n  <\/TABLE>>, shape = \"plaintext\"] \n\n\"sdg_targets\":\"goal_id\"->\"sdg_goals\":\"goals_id\" [id=\"sdg_targets_1\"]\n\"sdg_indicators\":\"goal_id, target_id\"->\"sdg_targets\":\"goal_id, target_id\" [id=\"sdg_indicators_1\"]\n\"sdg_items_codes\":\"goal_id, target_id, indicator_id\"->\"sdg_indicators\":\"goal_id, target_id, indicator_id\" [id=\"sdg_items_codes_1\"]\n\"sdg_items\":\"item_code\"->\"sdg_items_codes\":\"item_code\" [id=\"sdg_items_1\"]\n\"sdg_items\":\"area_code\"->\"area_codes_country\":\"area_code\" [id=\"sdg_items_2\"]\n\"sdg_items\":\"area_code\"->\"area_codes_global\":\"global_code\" [id=\"sdg_items_3\"]\n\"sdg_items\":\"area_code\"->\"area_codes_region\":\"region_code\" [id=\"sdg_items_4\"]\n\"sdg_items\":\"area_code\"->\"area_codes_sub_region\":\"sub_region_code\" [id=\"sdg_items_5\"]\n\"sdg_items\":\"area_code\"->\"area_codes_intermediate_region\":\"intermediate_region_code\" [id=\"sdg_items_6\"]\n}","config":{"engine":null,"options":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>
<div class="cell">

</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://utteranc.es/client.js" repo="ratnanil/ratnanil.github.io-utterances" issue-term="pathname" theme="github-light" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
      <div class="nav-footer-center">“The time has come”, the Walrus said, “To talk of many things..” - From The Walrus and the Carpenter by Lewis Carroll</div>
  </div>
</footer>



</body></html>